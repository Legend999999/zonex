<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zonex Digital Store</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <h1>Zonex</h1>
  <p>Buy PDFs, Tools, Guides, and Legal Games</p>
</header>

<nav>
  <button class="tab-btn active" data-target="games">Games</button>
  <button class="tab-btn" data-target="pdfs">PDFs</button>
  <button class="tab-btn" data-target="tools">Tools</button>
  <button class="tab-btn" data-target="guides">Guides</button>
</nav>

<div class="container">
  <input type="text" id="searchInput" placeholder="Search products..." class="search-input">
</div>

<div class="container">
  <div class="product-list active" id="games"></div>
  <div class="product-list" id="pdfs"></div>
  <div class="product-list" id="tools"></div>
  <div class="product-list" id="guides"></div>
</div>

<footer>
  &copy; 2026 Zonex Digital Store | All rights reserved
</footer>

<!-- INFO MODAL -->
<div id="infoModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6);">
  <div style="background:#fff; max-width:400px; margin:10% auto; padding:20px; border-radius:10px;">
    <h3 id="modalName"></h3>
    <p id="modalPrice"></p>
    <p id="modalDesc"></p>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
let productsData = {};

// Load products.json
async function loadProducts() {
const res = await fetch('/products.json');
  productsData = await res.json();
  renderProducts();
}

// Render products into categories
function renderProducts() {
  document.querySelectorAll('.product-list').forEach(list => list.innerHTML = '');

  Object.keys(productsData).forEach(category => {
    const container = document.getElementById(category);
    if (!container) return;

    productsData[category].forEach(p => {
      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `
        <h3>${p.name}</h3>
        <p>Price: ${p.price} IQD</p>
        <button class="buy-btn" onclick='showInfo(${JSON.stringify(p)})'>Info</button>
      `;
      container.appendChild(div);
    });
  });
}

// Modal logic
function showInfo(product) {
  document.getElementById('modalName').textContent = product.name;
  document.getElementById('modalPrice').textContent = 'Price: ' + product.price + ' IQD';
  document.getElementById('modalDesc').textContent = product.description || 'No description';
  document.getElementById('infoModal').style.display = 'block';
}

function closeModal() {
  document.getElementById('infoModal').style.display = 'none';
}

// Tabs
const tabs = document.querySelectorAll('.tab-btn');
tabs.forEach(tab => {
  tab.onclick = () => {
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    document.querySelectorAll('.product-list').forEach(l => l.classList.remove('active'));
    document.getElementById(tab.dataset.target).classList.add('active');

    document.getElementById('searchInput').value = '';
    filterProducts('');
  };
});

// Search
document.getElementById('searchInput').addEventListener('input', e => {
  filterProducts(e.target.value.toLowerCase());
});

function filterProducts(q) {
  const active = document.querySelector('.product-list.active');
  active.querySelectorAll('.product').forEach(p => {
    const text = p.querySelector('h3').textContent.toLowerCase();
    p.style.display = text.includes(q) ? 'block' : 'none';
  });
}

// Init
loadProducts();
</script>

</body>
</html>
